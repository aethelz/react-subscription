(this["webpackJsonpreact-subscription"]=this["webpackJsonpreact-subscription"]||[]).push([[0],{23:function(e,t,c){},24:function(e,t,c){},30:function(e,t,c){},31:function(e,t,c){},32:function(e,t,c){"use strict";c.r(t);var a=c(1),n=c.n(a),s=c(6),r=c.n(s),i=(c(23),c(8)),l=(c(24),c(25),c(12)),d=function(){return Object(l.b)()},o=l.c,u=c(14),j=[3,6,12],b=[5,10,50],m={cardNumber:"#### #### #### ####",cardMonth:"",cardYear:"",cardCvv:""},h={stage:"selection",subscriptionData:{duration:12,gbSize:5,upfrontPayment:!1},paymentData:null,confirmationData:null},O=Object(u.b)({name:"subscription",initialState:h,reducers:{nextStage:function(e){switch(e.stage){case"selection":e.stage="payment";break;case"payment":e.paymentData&&(e.stage="confirmation");break;default:console.log("no-op")}},previousStage:function(e){switch(e.stage){case"payment":e.stage="selection";break;case"confirmation":e.stage="payment";break;default:console.log("no-op")}},fillSubscriptionData:function(e,t){e.subscriptionData=t.payload},fillPaymentData:function(e,t){e.paymentData=t.payload},fillConfirmationData:function(e,t){e.confirmationData=t.payload}}}),f=O.actions,p=f.nextStage,x=f.previousStage,v=f.fillSubscriptionData,N=f.fillPaymentData,g=f.fillConfirmationData,_=function(e){return e.subscription.confirmationData},C=function(e){return e.subscription.subscriptionData},y=function(e){return e.subscription.stage},S=function(e){return e.subscription.paymentData},k=O.reducer,D=c(2);function F(e){var t=Object(a.useState)(null),c=Object(D.a)(t,2),n=c[0],s=c[1];if(Object(a.useEffect)((function(){fetch("https://cloud-storage-prices-moberries.herokuapp.com/prices").then((function(e){return e.json()})).then((function(e){return s(e)}))}),[]),!e)return null;var r=e.duration,i=e.gbSize,l=e.upfrontPayment?.1:0;if(n){var d,o=null===(d=n.subscription_plans.find((function(e){return e.duration_months===r})))||void 0===d?void 0:d.price_usd_per_gb;return o?{totalPrice:o*i*r*(1-l),pricePerGb:o}:null}return null}var R=c(0),B=function(e){var t=e.children;return Object(R.jsxs)("div",{className:"my-5 box has-background-info-light",children:[Object(R.jsx)("div",{className:"has-text-centered",children:Object(R.jsx)("h3",{className:"title is-3 mb-4",children:"Order Summary"})}),t]})},M=function(e){var t=e.text;return Object(R.jsx)(B,{children:Object(R.jsx)("div",{className:"has-text-centered",children:Object(R.jsx)("h4",{className:"title is-4",children:t})})})},E=function(){var e=o(C),t=F(e);if(!e)return Object(R.jsx)(M,{text:"No plan selected!"});if(!t)return Object(R.jsx)(M,{text:"Loading.."});var c=t.totalPrice,a=t.pricePerGb,n=e.duration,s=e.gbSize,r=e.upfrontPayment;return Object(R.jsx)(B,{children:Object(R.jsxs)("nav",{className:"level",children:[Object(R.jsx)("div",{className:"level-item has-text-centered",children:Object(R.jsxs)("div",{children:[Object(R.jsx)("p",{className:"heading",children:"Storage"}),Object(R.jsxs)("p",{className:"title",children:[s,"GB"]})]})}),Object(R.jsx)("div",{className:"level-item has-text-centered",children:Object(R.jsxs)("div",{children:[Object(R.jsx)("p",{className:"heading",children:"Duration"}),Object(R.jsxs)("p",{className:"title",children:[n," months"]})]})}),Object(R.jsx)("div",{className:"level-item has-text-centered",children:Object(R.jsxs)("div",{children:[Object(R.jsx)("p",{className:"heading",children:"Price per GB"}),Object(R.jsxs)("p",{className:"title",children:[a,"\u20ac"]})]})}),Object(R.jsx)("div",{className:"level-item has-text-centered",children:Object(R.jsxs)("div",{children:[Object(R.jsx)("p",{className:"heading",children:"Total Price"}),Object(R.jsxs)("p",{className:"title",style:{color:r?"red":""},children:[c,"\u20ac"]})]})})]})})},P=c(10),Y=c.n(P),H=function(e){var t=e.values,c=e.selected,a=e.onChange,n=e.unit;return Object(R.jsx)("div",{className:"buttons is-justify-content-center",children:t.map((function(e,t){return Object(R.jsxs)("button",{className:Y()("button","is-rounded",{"is-outline":e!==c,"is-info":e===c}),onClick:function(){return a(e)},children:[e," ",n]},t)}))})},I=function(e){var t=e.navigation,c=d(),n=o(C),s=Object(a.useState)(n.duration),r=Object(D.a)(s,2),i=r[0],l=r[1],u=Object(a.useState)(n.gbSize),m=Object(D.a)(u,2),h=m[0],O=m[1],f=Object(a.useState)(n.upfrontPayment),p=Object(D.a)(f,2),x=p[0],N=p[1];return Object(a.useEffect)((function(){c(v({duration:i,gbSize:h,upfrontPayment:x}))}),[c,h,i,x]),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(H,{values:j,selected:i,onChange:l,unit:"months"}),Object(R.jsx)(H,{values:b,selected:h,onChange:O,unit:"GB"}),Object(R.jsx)("div",{className:"has-text-centered",children:Object(R.jsxs)("label",{className:"checkbox",children:[Object(R.jsx)("input",{type:"checkbox",checked:x,onChange:function(e){var t=e.currentTarget.checked;return N(t)}}),Object(R.jsx)("span",{className:"title is-5 ml-2",children:"Pay Upfront"})]})}),t({})]})},L=c(13),w=(c(30),(new Date).getFullYear()),$=Array.from({length:12},(function(e,t){var c=t+1;return c<=9?"0"+c:c})),A=Array.from({length:9},(function(e,t){return w+t}));function T(e){var t=e.cardMonth,c=e.cardYear,n=e.onUpdateState,s=e.cardNumberRef,r=e.cardDateRef,i=e.onCardInputFocus,l=e.onCardInputBlur,d=e.cardCvvRef,o=e._cardNumber,u=e._cardCvv,j=e.children,b=Object(a.useState)(o===m.cardNumber?"":o),h=Object(D.a)(b,2),O=h[0],f=h[1],p=Object(a.useState)(u),x=Object(D.a)(p,2),v=x[0],N=x[1],g=function(e){var t=e.target,c=t.name,a=t.value;n(c,a)};return Object(R.jsxs)("div",{className:"card-form",children:[Object(R.jsx)("div",{className:"card-list",children:j}),Object(R.jsxs)("div",{className:"card-form__inner",children:[Object(R.jsxs)("div",{className:"card-input",children:[Object(R.jsx)("label",{htmlFor:"cardNumber",className:"card-input__label",children:"Card Number"}),Object(R.jsx)("input",{type:"tel",name:"cardNumber",className:"card-input__input",autoComplete:"off",onChange:function(e){var t=e.target,c=t.value,a=t.name,s=c;c=c.replace(/\D/g,""),/^3[47]\d{0,13}$/.test(c)||/^3(?:0[0-5]|[68]\d)\d{0,11}$/.test(c)?s=c.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 "):/^\d{0,16}$/.test(c)&&(s=c.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{4})/,"$1 $2 ").replace(/(\d{4}) (\d{4}) (\d{4})/,"$1 $2 $3 ")),f(s.trimRight()),n(a,s)},maxLength:"19",ref:s,onFocus:function(e){return i(e,"cardNumber")},onBlur:l,value:O})]}),Object(R.jsxs)("div",{className:"card-form__row",children:[Object(R.jsx)("div",{className:"card-form__col",children:Object(R.jsxs)("div",{className:"card-form__group",children:[Object(R.jsx)("label",{htmlFor:"cardMonth",className:"card-input__label",children:"Expiration Date"}),Object(R.jsxs)("select",{className:"card-input__input -select",value:t,name:"cardMonth",onChange:g,ref:r,onFocus:function(e){return i(e,"cardDate")},onBlur:l,children:[Object(R.jsx)("option",{value:"",disabled:!0,children:"Month"}),$.map((function(e,t){return Object(R.jsx)("option",{value:e,children:e},t)}))]}),Object(R.jsxs)("select",{name:"cardYear",className:"card-input__input -select",value:c,onChange:g,onFocus:function(e){return i(e,"cardDate")},onBlur:l,children:[Object(R.jsx)("option",{value:"",disabled:!0,children:"Year"}),A.map((function(e,t){return Object(R.jsx)("option",{value:e,children:e},t)}))]})]})}),Object(R.jsx)("div",{className:"card-form__col -cvv",children:Object(R.jsxs)("div",{className:"card-input",children:[Object(R.jsx)("label",{htmlFor:"cardCvv",className:"card-input__label",children:"CVV"}),Object(R.jsx)("input",{type:"tel",className:"card-input__input",maxLength:"3",autoComplete:"off",name:"cardCvv",onChange:function(e){var t=e.target,c=t.name,a=t.value.replace(/\D/g,"");N(a),n(c,a)},onFocus:function(e){n("isCardFlipped",!0)},onBlur:function(e){n("isCardFlipped",!1)},ref:d,value:v})]})})]})]})]})}var z=c(36),G=c(35),U=c(34),V=(c(31),{visa:"^4",amex:"^(34|37)",mastercard:"^5[1-5]",discover:"^6011",unionpay:"^62",troy:"^9792",diners:"^(30[0-5]|36)"}),J=function(){var e=Math.floor(5*Math.random()+1);return"".concat(e,".jpeg")}(),W=function(e){var t=e.cardHolder,c=e.cardNumber,n=e.cardMonth,s=e.cardYear,r=e.cardCvv,i=e.isCardFlipped,l=e.currentFocusedElm,d=e.onCardElementClick,o=e.cardNumberRef,u=e.cardHolderRef,j=e.cardDateRef,b=Object(a.useState)(null),m=Object(D.a)(b,2),h=m[0],O=m[1],f=Object(a.useMemo)((function(){return function(e){for(var t,c=e,a=0,n=Object.entries(V);a<n.length;a++){var s=Object(D.a)(n[a],2),r=s[0],i=s[1];if(t=new RegExp(i),null!=c.match(t))return r}return"visa"}(c)}),[c]);Object(a.useEffect)((function(){if(l){var e=(t=l.current)?{width:"".concat(t.offsetWidth,"px"),height:"".concat(t.offsetHeight,"px"),transform:"translateX(".concat(t.offsetLeft,"px) translateY(").concat(t.offsetTop,"px)")}:null;O(e)}var t}),[l]);return Object(R.jsxs)("div",{className:"card-item "+(i?"-active":""),children:[Object(R.jsxs)("div",{className:"card-item__side -front",children:[Object(R.jsx)("div",{className:"card-item__focus ".concat(l?"-active":""),style:h}),Object(R.jsx)("div",{className:"card-item__cover",children:Object(R.jsx)("img",{alt:"",src:"/card-background/".concat(J),className:"card-item__bg"})}),Object(R.jsxs)("div",{className:"card-item__wrapper",children:[Object(R.jsxs)("div",{className:"card-item__top",children:[Object(R.jsx)("img",{src:"".concat("/react-subscription","/chip.png"),alt:"",className:"card-item__chip"}),Object(R.jsx)("div",{className:"card-item__type",children:Object(R.jsx)("img",{alt:f,src:"".concat("/react-subscription","/card-type/").concat(f,".png"),className:"card-item__typeImg"})})]}),Object(R.jsx)("label",{className:"card-item__number",ref:o,onClick:function(){return d("cardNumber")},children:Object(R.jsx)(z.a,{className:"slide-fade-up",component:"div",children:c?function(e){var t=e.split("");return t.forEach((function(e,c){c>4&&c<14&&" "!==t[c]&&(t[c]="*")})),t}(c).map((function(e,t){return Object(R.jsx)(G.a,{classNames:"slide-fade-up",timeout:250,children:Object(R.jsx)("div",{className:"card-item__numberItem",children:e})},t)})):Object(R.jsx)(G.a,{classNames:"slide-fade-up",timeout:250,children:Object(R.jsx)("div",{className:"card-item__numberItem",children:"#"})})})}),Object(R.jsxs)("div",{className:"card-item__content",children:[Object(R.jsxs)("label",{className:"card-item__info",onClick:function(){return d("cardHolder")},ref:u,children:[Object(R.jsx)("div",{className:"card-item__holder",children:"Card Holder"}),Object(R.jsx)("div",{className:"card-item__name",children:Object(R.jsx)(z.a,{component:"div",className:"slide-fade-up",children:"FULL NAME"===t?Object(R.jsx)(G.a,{classNames:"slide-fade-up",timeout:250,children:Object(R.jsx)("div",{children:"FULL NAME"})}):t.split("").map((function(e,t){return Object(R.jsx)(G.a,{timeout:250,classNames:"slide-fade-right",children:Object(R.jsx)("span",{className:"card-item__nameItem",children:e})},t)}))})})]}),Object(R.jsxs)("div",{className:"card-item__date",onClick:function(){return d("cardDate")},ref:j,children:[Object(R.jsx)("label",{className:"card-item__dateTitle",children:"Expires"}),Object(R.jsx)("label",{className:"card-item__dateItem",children:Object(R.jsx)(U.a,{"in-out":!0,children:Object(R.jsx)(G.a,{classNames:"slide-fade-up",timeout:200,children:Object(R.jsxs)("span",{children:[n||"MM"," "]})},n)})}),"/",Object(R.jsx)("label",{htmlFor:"cardYear",className:"card-item__dateItem",children:Object(R.jsx)(U.a,{"out-in":!0,children:Object(R.jsx)(G.a,{classNames:"slide-fade-up",timeout:250,children:Object(R.jsx)("span",{children:s?s.toString().substr(-2):"YY"})},s)})})]})]})]})]}),Object(R.jsxs)("div",{className:"card-item__side -back",children:[Object(R.jsx)("div",{className:"card-item__cover",children:Object(R.jsx)("img",{alt:"",src:"".concat("/react-subscription","/card-background/").concat(J),className:"card-item__bg"})}),Object(R.jsx)("div",{className:"card-item__band"}),Object(R.jsxs)("div",{className:"card-item__cvv",children:[Object(R.jsx)("div",{className:"card-item__cvvTitle",children:"CVV"}),Object(R.jsx)("div",{className:"card-item__cvvBand",children:Object(R.jsx)(z.a,{children:r.split("").map((function(e,t){return Object(R.jsx)(G.a,{classNames:"zoom-in-out",timeout:250,children:Object(R.jsx)("span",{children:"*"})},t)}))})}),Object(R.jsx)("div",{className:"card-item__type",children:Object(R.jsx)("img",{alt:f,src:"".concat("/react-subscription","/card-type/").concat(f,".png"),className:"card-item__typeImg"})})]})]})]})},q=function(e){var t=e.state,c=e.setState,n=e.initialState,s=Object(a.useState)(null),r=Object(D.a)(s,2),l=r[0],d=r[1],o=Object(a.useCallback)((function(e,a){c(Object(i.a)(Object(i.a)({},t),{},Object(L.a)({},e,a||n[e])))}),[t]),u={cardNumber:Object(a.useRef)(),cardHolder:Object(a.useRef)(),cardDate:Object(a.useRef)(),cardCvv:Object(a.useRef)()},j=Object(a.useCallback)((function(e){u[e].current.focus()}),[]),b={cardNumber:Object(a.useRef)(),cardHolder:Object(a.useRef)(),cardDate:Object(a.useRef)()},m=Object(a.useCallback)((function(){d(null)}),[]);return Object(R.jsx)("div",{className:"wrapper",children:Object(R.jsx)(T,{cardMonth:t.cardMonth,cardYear:t.cardYear,_cardNumber:t.cardNumber,_cardCvv:t.cardCvv,onUpdateState:o,cardNumberRef:u.cardNumber,cardDateRef:u.cardDate,cardCvvRef:u.cardCvv,onCardInputFocus:function(e,t){d(b[t])},onCardInputBlur:m,children:Object(R.jsx)(W,{cardNumber:t.cardNumber,cardHolder:t.cardHolder,cardMonth:t.cardMonth,cardYear:t.cardYear,cardCvv:t.cardCvv,isCardFlipped:t.isCardFlipped,currentFocusedElm:l,onCardElementClick:j,cardNumberRef:b.cardNumber,cardHolderRef:b.cardHolder,cardDateRef:b.cardDate})})})};function X(e){return Object(i.a)(Object(i.a)({},e),{},{cardHolder:"CARD HOLDER",isCardFlipped:!1})}var K=function(e){var t,c=e.navigation,n=null!==(t=o(S))&&void 0!==t?t:m,s=X(n),r=d(),i=Object(a.useState)((function(){return X(n)})),l=Object(D.a)(i,2),u=l[0],j=l[1],b=[!u.cardNumber.startsWith("#")&&19===u.cardNumber.length,3===u.cardCvv.length,u.cardYear,u.cardMonth].every(Boolean);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(q,{initialState:s,state:u,setState:j}),c({formFilled:b,onNext:function(){return r(N(u))}})]})},Q=Object(u.a)({reducer:{subscription:k}}),Z=Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("span",{children:"Confirm"}),Object(R.jsx)("span",{className:"icon is-small",children:Object(R.jsx)("i",{className:"far fa-check-circle"})})]}),ee=Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("span",{children:"Success!"}),Object(R.jsx)("span",{className:"icon is-small",children:Object(R.jsx)("i",{className:"fas fa-check-circle"})})]}),te=Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("span",{children:"Failed :("}),Object(R.jsx)("span",{className:"icon is-small",children:Object(R.jsx)("i",{className:"fas fa-times-circle"})})]});function ce(){var e=Object(a.useState)(!1),t=Object(D.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)(!1),r=Object(D.a)(s,2),i=r[0],l=r[1],d=Object(a.useState)(!1),o=Object(D.a)(d,2),u=o[0],j=o[1];return{isLoading:c,isSuccess:u,isFailed:i,nextButtonContent:u?ee:i?te:Z,post:function(e){var t;n(!0),(t=e,fetch("https://httpbin.org/post",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()}))).then((function(){return j(!0)})).catch((function(){return l(!0)})).finally((function(){return n(!1)}))}}}var ae=function(e){var t,c,n=e.navigation,s=Object(a.useRef)(null),r=Object(a.useState)(!1),i=Object(D.a)(r,2),l=i[0],u=i[1],j=ce(),b=j.post,m=j.isLoading,h=j.isSuccess,O=j.nextButtonContent,f=o(_),p=d(),x=Object(a.useState)(null===(t=null===f||void 0===f?void 0:f.termsAgreement)||void 0===t||t),v=Object(D.a)(x,2),N=v[0],C=v[1],y=Object(a.useState)(null!==(c=null===f||void 0===f?void 0:f.email)&&void 0!==c?c:""),S=Object(D.a)(y,2),k=S[0],F=S[1];return Object(a.useEffect)((function(){s.current&&u(s.current.checkValidity())}),[k]),Object(R.jsxs)("div",{children:[Object(R.jsx)("div",{className:"field",children:Object(R.jsxs)("p",{className:"control has-icons-left has-icons-right",children:[Object(R.jsx)("input",{className:"input",type:"email",value:k,placeholder:"Email",ref:s,onChange:function(e){var t=e.currentTarget.value;return F(t)},size:30,required:!0}),Object(R.jsx)("span",{className:"icon is-small is-left",children:Object(R.jsx)("i",{className:"fas fa-envelope"})}),Object(R.jsx)("span",{className:Y()("icon","is-small","is-right",{"has-text-success":l}),children:Object(R.jsx)("i",{className:"fas fa-check"})})]})}),Object(R.jsx)("div",{className:"has-text-centered",children:Object(R.jsxs)("label",{className:"checkbox",children:[Object(R.jsx)("input",{name:"termsAgreement",type:"checkbox",checked:N,onChange:function(e){var t=e.currentTarget.checked;return C(t)}}),Object(R.jsxs)("span",{className:"title is-5 ml-2",children:["I agree to the ",Object(R.jsx)("a",{href:"#",children:"terms and conditions"})]})]})}),n({formFilled:N&&l&&!h,onPrevious:function(){p(g({email:k,termsAgreement:N}))},nextButtonContent:O,nextButtonLoading:m,onNext:function(){p(g({email:k,termsAgreement:N})),b(Q.getState().subscription)}})]})},ne=function(e){var t=e.navigation;switch(o(y)){case"selection":return Object(R.jsx)(I,{navigation:t});case"payment":return Object(R.jsx)(K,{navigation:t});case"confirmation":return Object(R.jsx)(ae,{navigation:t});default:return null}},se=Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("span",{children:"Next"}),Object(R.jsx)("span",{className:"icon is-small",children:Object(R.jsx)("i",{className:"fas fa-chevron-right"})})]}),re=function(e){var t=e.formFilled,c=void 0===t||t,a=e.onNext,n=void 0===a?function(){}:a,s=e.onPrevious,r=void 0===s?function(){}:s,i=e.nextButtonContent,l=void 0===i?se:i,u=e.nextButtonLoading,j=void 0!==u&&u,b=d(),m=o(y);return Object(R.jsxs)("div",{className:"buttons is-justify-content-space-between mt-5",children:[Object(R.jsxs)("button",{className:"button is-primary is-outlined",disabled:"selection"===m,onClick:function(){r(),b(x())},children:[Object(R.jsx)("span",{className:"icon is-small",children:Object(R.jsx)("i",{className:"fas fa-chevron-left"})}),Object(R.jsx)("span",{children:"Back"})]}),Object(R.jsx)("button",{disabled:!c,className:Y()("button","is-primary",{"is-loading":j}),onClick:function(){n(),b(p())},children:l})]})};var ie=function(){return Object(R.jsx)("section",{className:"section",children:Object(R.jsx)("div",{className:"container",children:Object(R.jsx)("div",{className:"columns is-centered",children:Object(R.jsxs)("div",{className:"column is-6 is-5-desktop",children:[Object(R.jsx)("div",{className:"has-text-centered",children:Object(R.jsx)("h1",{className:"title is-2",children:"Cloud storage subscription"})}),Object(R.jsx)(E,{}),Object(R.jsx)(ne,{navigation:function(e){return Object(R.jsx)(re,Object(i.a)({},e))}})]})})})})};r.a.render(Object(R.jsx)(n.a.StrictMode,{children:Object(R.jsx)(l.a,{store:Q,children:Object(R.jsx)(ie,{})})}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.7472ce60.chunk.js.map